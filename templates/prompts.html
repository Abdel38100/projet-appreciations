{% extends "base.html" %}
{% block title %}Gestion des Prompts IA{% endblock %}
{% block content %}
<h2>Gestion des Prompts IA</h2>
<p>Vous pouvez définir et gérer les prompts utilisés pour la génération d'appréciations. Un seul prompt peut être actif à la fois.</p>

<a href="{{ url_for('main.add_prompt') }}" class="btn btn-primary mb-3">Ajouter un nouveau Prompt</a>

{% if not prompts %}
<div class="alert alert-info">Aucun prompt n'est configuré pour le moment. Veuillez en ajouter un.</div>
{% else %}
<div class="list-group">
    {% for prompt in prompts %}
    <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-center {% if prompt.is_active %}list-group-item-success{% endif %}">
        <div>
            <h5 class="mb-1">{{ prompt.name }} {% if prompt.is_active %}<span class="badge bg-success">Actif</span>{% endif %}</h5>
            <small class="text-muted">Créé le {{ prompt.created_at.strftime('%d/%m/%Y %H:%M') }}</small>
        </div>
        <div class="btn-group" role="group">
            <a href="{{ url_for('main.edit_prompt', prompt_id=prompt.id) }}" class="btn btn-sm btn-secondary">Modifier</a>
            {% if not prompt.is_active %}
            <form action="{{ url_for('main.set_active_prompt', prompt_id=prompt.id) }}" method="POST" class="d-inline-block ms-1">
                <button type="submit" class="btn btn-sm btn-success">Activer</button>
            </form>
            <form action="{{ url_for('main.delete_prompt', prompt_id=prompt.id) }}" method="POST" onsubmit="return confirm('Voulez-vous supprimer ce prompt ?');" class="d-inline-block ms-1">
                <button type="submit" class="btn btn-sm btn-danger">Supprimer</button>
            </form>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}
{% endblock %}