{% extends "base.html" %}

{% block title %}Historique des Analyses{% endblock %}

{% block content %}
<h2>Historique des Analyses Sauvegardées</h2>

{% for analyse in analyses %}
<div class="card mb-3">
  <div class="card-header d-flex justify-content-between align-items-center">
    <strong>{{ analyse.nom_eleve }}</strong>
    <small class="text-muted">Analysé le {{ analyse.cree_le.strftime('%d/%m/%Y à %Hh%M') }}</small>
  </div>
  <div class="card-body">
    <h5 class="card-title">Appréciation Générale</h5>
    <p class="card-text bg-light p-2 rounded">{{ analyse.appreciation_principale }}</p>
    
    <p>
      <a class="btn btn-secondary btn-sm" data-bs-toggle="collapse" href="#justifications-{{ analyse.id }}" role="button" aria-expanded="false" aria-controls="justifications-{{ analyse.id }}">
        Voir/Cacher les justifications
      </a>
    </p>
    <div class="collapse" id="justifications-{{ analyse.id }}">
      <div class="card card-body">
        {{ analyse.justifications | markdown }}
      </div>
    </div>
  </div>
</div>
{% else %}
<div class="alert alert-info">Aucune analyse n'a encore été sauvegardée dans l'historique.</div>
{% endfor %}
{% endblock %}